import os

import sqlalchemy as sa
from sqlalchemy.orm import sessionmaker, relationship
from sqlalchemy.ext.declarative import declarative_base

if os.path.isfile("foo1.db"):
    os.remove("foo1.db")
        
engine = sa.create_engine('sqlite:///foo1.db', echo=False)

Base = declarative_base()
Base.metadata.create_all(engine)

session = sessionmaker()
session.configure(bind=engine)


class MetaEvent(Base):
    __tablename__ = "metaevent"

    id = sa.Column(sa.Integer, primary_key=True)
    events = relationship("Event", back_populates="metaevent")

class Event(Base):
    __tablename__ = "event"

    id = sa.Column(sa.Integer, primary_key=True)
    frame = relationship("Frame")
    time = relationship("EventTime")
    line = relationship("Line", uselist=False, back_populates="event")
    
    
    metaevent_id = sa.Column(sa.Integer, sa.ForeignKey("metaevent.id"))
    metaevent = relationship("MetaEvent", back_populates="event")



class Line(Base):
    __tablename__ = "line"

    id = sa.Column(sa.Integer, primary_key=True)

    event_id = sa.Column(sa.Integer, sa.ForeignKey("event.id"))
    event = relationship("Event", back_populates="line")
    